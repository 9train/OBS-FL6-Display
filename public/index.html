<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>FLX Visualizer (OBS)</title>
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <link rel="stylesheet" href="./styles.css" />
</head>
<body>
  <div id="ui">
    <div class="left">
      <button id="fit">Fit</button>
      <button id="fill">Fill</button>
      <button id="toggleBG">Toggle BG</button>
    </div>
    <div class="right">
      <span id="status">WS: ‚è≥</span>
    </div>
  </div>
  <section id="boardHost" aria-label="Controller visual"></section>

  <script type="module">
    import { initBoard, consumeInfo } from '/src/board.js';
    import { connectWS } from '/src/ws.js';
    import { initWebMIDI } from '/src/midi.js';

    await initBoard({ hostId: 'boardHost' });

    // WebSocket stream (from Node bridges)
    connectWS('ws://localhost:8787', (info) => consumeInfo(info), (st) => {
      document.getElementById('status').textContent = 'WS: ' + st;
    });

    // Optional: also listen to WebMIDI (e.g., IAC Bus) directly in the browser
    initWebMIDI((info) => consumeInfo(info));

    // simple UI controls
    const host = document.getElementById('boardHost');
    document.getElementById('fit').onclick  = () => host.classList.remove('fill');
    document.getElementById('fill').onclick = () => host.classList.add('fill');
    document.getElementById('toggleBG').onclick = () => document.body.classList.toggle('transparent');
  </script>
</body>
</html>
